---
title: "Trabajo Practico - Laboratorio de Datos"
author: "Morales Joaquin, Lasorsa Lautaro y Palazzo Tomas"
date: "14/10/2021"
output:
  html_document:
    df_print: paged
    toc: yes
  html_notebook:
    theme: lumen
    toc: yes
    toc_float: yes
subtitle: "Laboratorio de Datos"
---

```{r}
# Librerias
require(tidyverse)
require(geosphere)
require(rvest) # Cargamos el paquete
```


```{r}
# Llamamos a los DataSets

datos_2014 = read.csv('../TP_LaboDeDatos/Data/aterrizajes-y-despegues-registrados-por-eana-2014.csv', encoding = 'latin1', sep = ';')
datos_2015 = read.csv('../TP_LaboDeDatos/Data/aterrizajes-y-despegues-registrados-por-eana-2015.csv', encoding = 'latin1', sep = ';')
datos_2016 = read.csv('../TP_LaboDeDatos/Data/aterrizajes-y-despegues-registrados-por-eana-2016.csv', encoding = 'latin1', sep = ';')
datos_2017 = read.csv('../TP_LaboDeDatos/Data/aterrizajes-y-despegues-registrados-por-eana-2017.csv', encoding = 'latin1', sep = ';')
datos_2018 = read.csv('../TP_LaboDeDatos/Data/aterrizajes-y-despegues-registrados-por-eana-2018.csv', encoding = 'latin1', sep = ';')
datos_2019 = read.csv('../TP_LaboDeDatos/Data/aterrizajes-y-despegues-registrados-por-eana-2019.csv', encoding = 'latin1', sep = ';')
datos_2020 = read.csv('../TP_LaboDeDatos/Data/aterrizajes-y-despegues-registrados-por-eana-2020.csv', encoding = 'latin1', sep = ';')

# Concateno todos los datos
datos = rbind(datos_2014,datos_2015,datos_2016,datos_2017,datos_2018,datos_2019,datos_2020)

```

```{r}
# Utilizamos la tabla que se encuentra en 'https://en.wikipedia.org/wiki/List_of_airports_in_Argentina'
# para acceder a las variables de ciudad, provincia y coordenadas de cada aeropuerto 
aeropuertos_wiki = read_html('https://en.wikipedia.org/wiki/List_of_airports_in_Argentina')
elemento_tabla  = html_element(var_extras,'.wikitable')

aeropuertos = html_table(elemento_tabla)

```


```{r}
# Agregando Ciudades
N = dim(datos)[1]
cant_aeropuertos = dim(aeropuertos)[1]

datos$ciudad_origen     = rep(NA, length(N))
datos$ciudad_destino    = rep(NA, length(N))
datos$provincia_origen  = rep(NA, length(N))
datos$provincia_destino = rep(NA, length(N))
# datos %>% mutate(ciudad_origen = ) # Aca queria hacer exactamente lo de arriba pero usando dplyr



# El algoritmo de abajo ndar anda, tarda un monton. Hay que agregar el resto de las variables
for (i in 1:N){
  for (j in 1:cant_aeropuertos){
    if (datos$Origen.OACI[i] == aeropuertos$ICAO[j]) {
        datos$ciudad_origen[i] = aeropuertos$`CityÂ served`[j] 
        datos$provincia_origen[i] = aeropuertos$Province[j]
    }
  }
}



```




